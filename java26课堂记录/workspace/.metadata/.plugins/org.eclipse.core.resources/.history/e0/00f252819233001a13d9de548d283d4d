package test;

import java.io.FileOutputStream;
import java.io.IOException;
import java.util.Date;

import org.apache.poi.hpsf.DocumentSummaryInformation;
import org.apache.poi.hpsf.SummaryInformation;
import org.apache.poi.hssf.usermodel.HSSFCell;
import org.apache.poi.hssf.usermodel.HSSFClientAnchor;
import org.apache.poi.hssf.usermodel.HSSFComment;
import org.apache.poi.hssf.usermodel.HSSFFooter;
import org.apache.poi.hssf.usermodel.HSSFHeader;
import org.apache.poi.hssf.usermodel.HSSFPatriarch;
import org.apache.poi.hssf.usermodel.HSSFRichTextString;
import org.apache.poi.hssf.usermodel.HSSFRow;
import org.apache.poi.hssf.usermodel.HSSFSheet;
import org.apache.poi.hssf.usermodel.HSSFWorkbook;

public class TestPOI_1 {

	public static void main(String[] args) throws IOException {
		String filePath = "d:\\sample.xls";// 文件路径
		HSSFWorkbook workbook = new HSSFWorkbook();// 创建Excel文件(Workbook)
		HSSFSheet sheet = workbook.createSheet();// 创建工作表(Sheet)
		sheet = workbook.createSheet("Test");// 创建工作表(Sheet)
		
	    HSSFRow row = sheet.createRow(0);// 创建行,从0开始
	    HSSFCell cell = row.createCell(0);// 创建行的单元格,也是从0开始
	    cell.setCellValue("李志伟");// 设置单元格内容
	    row.createCell(1).setCellValue(false);// 设置单元格内容,重载
	    row.createCell(2).setCellValue(new Date());// 设置单元格内容,重载
	    row.createCell(3).setCellValue(12.345);// 设置单元格内容,重载
	    
	    //创建文档摘要信息

	    workbook.createInformationProperties();//创建文档信息
	    DocumentSummaryInformation dsi=workbook.getDocumentSummaryInformation();//摘要信息
	    dsi.setCategory("类别:Excel文件");//类别
	    dsi.setManager("管理者:李志伟");//管理者
	    dsi.setCompany("公司:--");//公司
	    SummaryInformation si = workbook.getSummaryInformation();//摘要信息
	    si.setSubject("主题:--");//主题
	    si.setTitle("标题:测试文档");//标题
	    si.setAuthor("作者:李志伟");//作者
	    si.setComments("备注:POI测试文档");//备注
	    
	 //   创建批注
	    HSSFPatriarch patr = sheet.createDrawingPatriarch();
	    HSSFClientAnchor anchor = patr.createAnchor(0, 0, 0, 0, 5, 1, 8,3);//创建批注位置
	    HSSFComment comment = patr.createCellComment(anchor);//创建批注
	    comment.setString(new HSSFRichTextString("这是一个批注段落！"));//设置批注内容
	    comment.setAuthor("李志伟");//设置批注作者
	    comment.setVisible(true);//设置批注默认显示
	    cell = sheet.createRow(2).createCell(1);
	    cell.setCellValue("测试");
	    cell.setCellComment(comment);//把批注赋值给单元格
//	    创建批注位置HSSFPatriarch.createAnchor(dx1, dy1, dx2, dy2, col1, row1, col2, row2)方法参数说明：
//
//	    dx1 第1个单元格中x轴的偏移量
//	    dy1 第1个单元格中y轴的偏移量
//	    dx2 第2个单元格中x轴的偏移量
//	    dy2 第2个单元格中y轴的偏移量
//	    col1 第1个单元格的列号
//	    row1 第1个单元格的行号
//	    col2 第2个单元格的列号
//	    row2 第2个单元格的行号
       

	    HSSFHeader header =sheet.getHeader();//得到页眉
	    header.setLeft("页眉左边");
	    header.setRight("页眉右边");
	    header.setCenter("页眉中间");
	    HSSFFooter footer =sheet.getFooter();//得到页脚
	    footer.setLeft("页脚左边");
	    footer.setRight("页脚右边");
	    footer.setCenter("页脚中间");



	    HSSFSheet sheet = workbook.createSheet("Test");// 创建工作表(Sheet)
	    HSSFRow row=sheet.createRow(0);
	    //设置日期格式--使用Excel内嵌的格式
	    HSSFCell cell=row.createCell(0);
	    cell.setCellValue(new Date());
	    HSSFCellStyle style=workbook.createCellStyle();
	    style.setDataFormat(HSSFDataFormat.getBuiltinFormat("m/d/yy h:mm"));
	    cell.setCellStyle(style);
	    //设置保留2位小数--使用Excel内嵌的格式
	    cell=row.createCell(1);
	    cell.setCellValue(12.3456789);
	    style=workbook.createCellStyle();
	    style.setDataFormat(HSSFDataFormat.getBuiltinFormat("0.00"));
	    cell.setCellStyle(style);
	    //设置货币格式--使用自定义的格式
	    cell=row.createCell(2);
	    cell.setCellValue(12345.6789);
	    style=workbook.createCellStyle();
	    style.setDataFormat(workbook.createDataFormat().getFormat("￥#,##0"));
	    cell.setCellStyle(style);
	    //设置百分比格式--使用自定义的格式
	    cell=row.createCell(3);
	    cell.setCellValue(0.123456789);
	    style=workbook.createCellStyle();
	    style.setDataFormat(workbook.createDataFormat().getFormat("0.00%"));
	    cell.setCellStyle(style);
	    //设置中文大写格式--使用自定义的格式
	    cell=row.createCell(4);
	    cell.setCellValue(12345);
	    style=workbook.createCellStyle();
	    style.setDataFormat(workbook.createDataFormat().getFormat("[DbNum2][$-804]0"));
	    cell.setCellStyle(style);
	    //设置科学计数法格式--使用自定义的格式
	    cell=row.createCell(5);
	    cell.setCellValue(12345);
	    style=workbook.createCellStyle();
	    style.setDataFormat(workbook.createDataFormat().getFormat("0.00E+00"));
	    cell.setCellStyle(style);


	    FileOutputStream out = new FileOutputStream(filePath);
		workbook.write(out);// 保存Excel文件
		out.close();// 关闭文件流
		System.out.println("OK!");

	}

}
